@page "/tipos-ioc"
@inherits TiposIOCListComponent

<div class="content-data mt-4">
    <h3>Tipos de IOC (Indicadores de Compromiso)</h3>
    <div class="add-margin">

        <!-- Botón para abrir el modal de importación -->
        <button @onclick="ShowImportModal" class="btn btn-primary mt-2">Importar Tipos de IOC</button>

        <Grid @ref="_tipoIOCGrid"
              TItem="TipoIOC"
              class="table table-hover table-bordered table-striped"
              DataProvider="TipoIOCDataProvider"
              AllowFiltering="false"
              Responsive="true"
              ItemsPerPageText=""
              PageSizeSelectorVisible="true"
              PageSize="20"
              PageSizeSelectorItems="null"
              EmptyText="No hay registros para mostrar">

            <GridColumn TItem="TipoIOC" HeaderText="Id" PropertyName="ID">
                @context.ID
            </GridColumn>
            <GridColumn TItem="TipoIOC" HeaderText="Nombre" PropertyName="Nombre">
                @context.Nombre
            </GridColumn>
            <GridColumn TItem="TipoIOC" HeaderText="Descripcion" PropertyName="Descripcion">
                @context.Descripcion
            </GridColumn>
            <GridColumn TItem="TipoIOC" HeaderText="Icono" PropertyName="Icono">
                @if (!string.IsNullOrWhiteSpace(context.Icono))
                {
                    <text>
                        @context.Icono
                        <Icon Name="@((IconName)Enum.Parse(typeof(IconName), context.Icono))" />
                    </text>
                }
                else
                {
                    <text>-- Sin ícono --</text>
                }
            </GridColumn>
            <GridColumn TItem="TipoIOC" HeaderText="Buscar En" PropertyName="BuscarEn">
                @context.BuscarEn.ToString()
            </GridColumn>

            <GridColumn TItem="TipoIOC" HeaderText="Acciones">
                <button class="btn btn-danger btn-sm" @onclick="() => DeleteTipoIOC(context.ID)">
                    <Icon Name="IconName.Trash" />
                </button>
            </GridColumn>
        </Grid>
    </div>
</div>

<!-- Modal para la importación de tipos de IOC -->
@if (isImportModalVisible)
{
    <div class="modal fade show" tabindex="-1" style="display: block;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Importar Tipos de IOC</h5>
                    <button type="button" class="btn-close" @onclick="HideImportModal"></button>
                </div>
                <div class="modal-body">
                    <InputFile OnChange="OnFileChange" class="form-control" />
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @onclick="HideImportModal">Cancelar</button>
                    <button class="btn btn-primary" @onclick="ImportTiposIOC">Importar</button>
                </div>
            </div>
        </div>
    </div>
}
